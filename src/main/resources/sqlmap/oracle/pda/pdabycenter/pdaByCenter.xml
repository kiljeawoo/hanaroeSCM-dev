<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="pdaByCenter">
	<!-- PDA 검수내역 센터별집계 -->
	<select id="selectPdaDetail" parameterType="java.util.Map" resultType="java.util.Map" fetchSize="1000">

		WITH TB_GLN_TEMP AS (
	 		SELECT '01' SEQ, '8808983304892' GLN FROM DUAL
			UNION ALL
			SELECT '02' SEQ, '8808983304908' GLN FROM DUAL
			UNION ALL
			SELECT '03' SEQ, '8808983300108' GLN FROM DUAL
			UNION ALL
			SELECT '05' SEQ, '8808983000312' GLN FROM DUAL
			UNION ALL
			SELECT '06' SEQ, '8808983000916' GLN FROM DUAL
			UNION ALL
			SELECT '08' SEQ, '8808983000510' GLN FROM DUAL
			UNION ALL
			SELECT '09' SEQ, '8808983305950' GLN FROM DUAL
			UNION ALL
			SELECT '11' SEQ, '8808983000411' GLN FROM DUAL
			UNION ALL
			SELECT '12' SEQ, '8808983327631' GLN FROM DUAL
		),
		TB_AP_MART_TEMP AS (
		SELECT '8808983120218' GLN FROM DUAL
		UNION ALL
		SELECT '8808983300597' GLN FROM DUAL
		UNION ALL
		SELECT '8808983300689' GLN FROM DUAL
		UNION ALL
		SELECT '8808983300818' GLN FROM DUAL
		UNION ALL
		SELECT '8808983300825' GLN FROM DUAL
		UNION ALL
		SELECT '8808983301235' GLN FROM DUAL
		UNION ALL
		SELECT '8808983301259' GLN FROM DUAL
		UNION ALL
		SELECT '8808983301273' GLN FROM DUAL
		UNION ALL
		SELECT '8808983301303' GLN FROM DUAL
		UNION ALL
		SELECT '8808983301358' GLN FROM DUAL
		UNION ALL
		SELECT '8808983302003' GLN FROM DUAL
		UNION ALL
		SELECT '8808983302508' GLN FROM DUAL
		UNION ALL
		SELECT '8808983304700' GLN FROM DUAL
		UNION ALL
		SELECT '8808983305783' GLN FROM DUAL
		UNION ALL
		SELECT '8808983305790' GLN FROM DUAL
		UNION ALL
		SELECT '8808983306094' GLN FROM DUAL
		UNION ALL
		SELECT '8808983306995' GLN FROM DUAL
		UNION ALL
		SELECT '8808983307039' GLN FROM DUAL
		UNION ALL
		SELECT '8808983307282' GLN FROM DUAL
		UNION ALL
		SELECT '8808983307312' GLN FROM DUAL
		UNION ALL
		SELECT '8808983307978' GLN FROM DUAL
		UNION ALL
		SELECT '8808983321615' GLN FROM DUAL
		UNION ALL
		SELECT '8808983321752' GLN FROM DUAL
		UNION ALL
		SELECT '8808983322322' GLN FROM DUAL
		UNION ALL
		SELECT '8808983323046' GLN FROM DUAL
		UNION ALL
		SELECT '8808983323602' GLN FROM DUAL
		UNION ALL
		SELECT '8808983323909' GLN FROM DUAL
		UNION ALL
		SELECT '8808983324197' GLN FROM DUAL
		UNION ALL
		SELECT '8808983324203' GLN FROM DUAL
		UNION ALL
		SELECT '8808983325552' GLN FROM DUAL
		UNION ALL
		SELECT '8808983325736' GLN FROM DUAL
		UNION ALL
		SELECT '8808983325804' GLN FROM DUAL
		UNION ALL
		SELECT '8808983325903' GLN FROM DUAL
		UNION ALL
		SELECT '8808983325958' GLN FROM DUAL
		UNION ALL
		SELECT '8808983325965' GLN FROM DUAL
		UNION ALL
		SELECT '8808983326016' GLN FROM DUAL
		UNION ALL
		SELECT '8808983326818' GLN FROM DUAL
		UNION ALL
		SELECT '8808983326993' GLN FROM DUAL
		UNION ALL
		SELECT '8808983327037' GLN FROM DUAL
		UNION ALL
		SELECT '8808983327211' GLN FROM DUAL
		UNION ALL
		SELECT '8808983327402' GLN FROM DUAL
		UNION ALL
		SELECT '8808983327518' GLN FROM DUAL
		UNION ALL
		SELECT '8808983328126' GLN FROM DUAL
		UNION ALL
		SELECT '8808983328300' GLN FROM DUAL
		UNION ALL
		SELECT '8808983410159' GLN FROM DUAL
		UNION ALL
		SELECT '8808983420028' GLN FROM DUAL
		UNION ALL
		SELECT '8808983420035' GLN FROM DUAL
		UNION ALL
		SELECT '8808983420059' GLN FROM DUAL
		UNION ALL
		SELECT '8808983420110' GLN FROM DUAL
		UNION ALL
		SELECT '8808983421117' GLN FROM DUAL
		UNION ALL
		SELECT '8808983421216' GLN FROM DUAL
		UNION ALL
		SELECT '8808983421315' GLN FROM DUAL
		UNION ALL
		SELECT '8808983430058' GLN FROM DUAL
		UNION ALL
		SELECT '8808983430065' GLN FROM DUAL
		UNION ALL
		SELECT '8808983431116' GLN FROM DUAL
		UNION ALL
		SELECT '8808983440019' GLN FROM DUAL
		UNION ALL
		SELECT '8808983610122' GLN FROM DUAL
		UNION ALL
		SELECT '8808983610252' GLN FROM DUAL
		UNION ALL
		SELECT '8808983610276' GLN FROM DUAL
		UNION ALL
		SELECT '8808983610337' GLN FROM DUAL
		UNION ALL
		SELECT '8808983610351' GLN FROM DUAL
		UNION ALL
		SELECT '8808983610375' GLN FROM DUAL
		UNION ALL
		SELECT '8808983610382' GLN FROM DUAL
		UNION ALL
		SELECT '8808983610399' GLN FROM DUAL
		UNION ALL
		SELECT '8808983610573' GLN FROM DUAL
		UNION ALL
		SELECT '8808983610580' GLN FROM DUAL
		UNION ALL
		SELECT '8808983610603' GLN FROM DUAL
		UNION ALL
		SELECT '8808983610818' GLN FROM DUAL
		UNION ALL
		SELECT '8808983610948' GLN FROM DUAL
		UNION ALL
		SELECT '8808983611051' GLN FROM DUAL
		UNION ALL
		SELECT '8808983611143' GLN FROM DUAL
		UNION ALL
		SELECT '8808983611150' GLN FROM DUAL
		UNION ALL
		SELECT '8808983611563' GLN FROM DUAL
		UNION ALL
		SELECT '8808983617077' GLN FROM DUAL
		UNION ALL
		SELECT '8808983617206' GLN FROM DUAL
		UNION ALL
		SELECT '8808983617312' GLN FROM DUAL
		UNION ALL
		SELECT '8808983617381' GLN FROM DUAL
		UNION ALL
		SELECT '8808983617404' GLN FROM DUAL
		UNION ALL
		SELECT '8808983617473' GLN FROM DUAL
		UNION ALL
		SELECT '8808983617497' GLN FROM DUAL
		UNION ALL
		SELECT '8808983617565' GLN FROM DUAL
		UNION ALL
		SELECT '8808983620152' GLN FROM DUAL
		UNION ALL
		SELECT '8808983620176' GLN FROM DUAL
		UNION ALL
		SELECT '8808983620206' GLN FROM DUAL
		UNION ALL
		SELECT '8808983620220' GLN FROM DUAL
		UNION ALL
		SELECT '8808983620497' GLN FROM DUAL
		UNION ALL
		SELECT '8808983620510' GLN FROM DUAL
		UNION ALL
		SELECT '8808983620886' GLN FROM DUAL
		UNION ALL
		SELECT '8808983620961' GLN FROM DUAL
		UNION ALL
		SELECT '8808983621050' GLN FROM DUAL
		UNION ALL
		SELECT '8808983621197' GLN FROM DUAL
		UNION ALL
		SELECT '8808983621340' GLN FROM DUAL
		UNION ALL
		SELECT '8808983621401' GLN FROM DUAL
		UNION ALL
		SELECT '8808983621500' GLN FROM DUAL
		UNION ALL
		SELECT '8808983621616' GLN FROM DUAL
		UNION ALL
		SELECT '8808983621678' GLN FROM DUAL
		UNION ALL
		SELECT '8808983622040' GLN FROM DUAL
		UNION ALL
		SELECT '8808983622149' GLN FROM DUAL
		UNION ALL
		SELECT '8808983622392' GLN FROM DUAL
		UNION ALL
		SELECT '8808983622477' GLN FROM DUAL
		UNION ALL
		SELECT '8808983622514' GLN FROM DUAL
		UNION ALL
		SELECT '8808983622590' GLN FROM DUAL
		UNION ALL
		SELECT '8808983622606' GLN FROM DUAL
		UNION ALL
		SELECT '8808983622705' GLN FROM DUAL
		UNION ALL
		SELECT '8808983622750' GLN FROM DUAL
		UNION ALL
		SELECT '8808983622798' GLN FROM DUAL
		UNION ALL
		SELECT '8808983622804' GLN FROM DUAL
		UNION ALL
		SELECT '8808983622835' GLN FROM DUAL
		UNION ALL
		SELECT '8808983622866' GLN FROM DUAL
		UNION ALL
		SELECT '8808983623108' GLN FROM DUAL
		UNION ALL
		SELECT '8808983623146' GLN FROM DUAL
		UNION ALL
		SELECT '8808983623290' GLN FROM DUAL
		UNION ALL
		SELECT '8808983623450' GLN FROM DUAL
		UNION ALL
		SELECT '8808983623467' GLN FROM DUAL
		UNION ALL
		SELECT '8808983623481' GLN FROM DUAL
		UNION ALL
		SELECT '8808983623832' GLN FROM DUAL
		UNION ALL
		SELECT '8808983623917' GLN FROM DUAL
		UNION ALL
		SELECT '8808983630014' GLN FROM DUAL
		UNION ALL
		SELECT '8808983630281' GLN FROM DUAL
		UNION ALL
		SELECT '8808983631004' GLN FROM DUAL
		UNION ALL
		SELECT '8808983631363' GLN FROM DUAL
		UNION ALL
		SELECT '8808983631554' GLN FROM DUAL
		UNION ALL
		SELECT '8808983631790' GLN FROM DUAL
		UNION ALL
		SELECT '8808983632438' GLN FROM DUAL
		UNION ALL
		SELECT '8808983632544' GLN FROM DUAL
		UNION ALL
		SELECT '8808983632551' GLN FROM DUAL
		UNION ALL
		SELECT '8808983632568' GLN FROM DUAL
		UNION ALL
		SELECT '8808983632636' GLN FROM DUAL
		UNION ALL
		SELECT '8808983632681' GLN FROM DUAL
		UNION ALL
		SELECT '8808983632704' GLN FROM DUAL
		UNION ALL
		SELECT '8808983632797' GLN FROM DUAL
		UNION ALL
		SELECT '8808983632858' GLN FROM DUAL
		UNION ALL
		SELECT '8808983633473' GLN FROM DUAL
		UNION ALL
		SELECT '8808983633503' GLN FROM DUAL
		UNION ALL
		SELECT '8808983633978' GLN FROM DUAL
		UNION ALL
		SELECT '8808983637532' GLN FROM DUAL
		UNION ALL
		SELECT '8808983640280' GLN FROM DUAL
		UNION ALL
		SELECT '8808983640563' GLN FROM DUAL
		UNION ALL
		SELECT '8808983641058' GLN FROM DUAL
		UNION ALL
		SELECT '8808983641591' GLN FROM DUAL
		UNION ALL
		SELECT '8808983641645' GLN FROM DUAL
		UNION ALL
		SELECT '8808983641805' GLN FROM DUAL
		UNION ALL
		SELECT '8808983641843' GLN FROM DUAL
		UNION ALL
		SELECT '8808983641966' GLN FROM DUAL
		UNION ALL
		SELECT '8808983642000' GLN FROM DUAL
		UNION ALL
		SELECT '8808983642086' GLN FROM DUAL
		UNION ALL
		SELECT '8808983642598' GLN FROM DUAL
		UNION ALL
		SELECT '8808983643229' GLN FROM DUAL
		UNION ALL
		SELECT '8808983643564' GLN FROM DUAL
		UNION ALL
		SELECT '8808983647210' GLN FROM DUAL
		UNION ALL
		SELECT '8808983650067' GLN FROM DUAL
		UNION ALL
		SELECT '8808983650869' GLN FROM DUAL
		UNION ALL
		SELECT '8808983660011' GLN FROM DUAL
		UNION ALL
		SELECT '8808983660042' GLN FROM DUAL
		UNION ALL
		SELECT '8808983660271' GLN FROM DUAL
		UNION ALL
		SELECT '8808983670119' GLN FROM DUAL
		UNION ALL
		SELECT '8808983670188' GLN FROM DUAL
		UNION ALL
		SELECT '8808983670232' GLN FROM DUAL
		UNION ALL
		SELECT '8808983670249' GLN FROM DUAL
		UNION ALL
		SELECT '8808983670317' GLN FROM DUAL
		UNION ALL
		SELECT '8808983670379' GLN FROM DUAL
		UNION ALL
		SELECT '8808983677026' GLN FROM DUAL
		UNION ALL
		SELECT '8808983680255' GLN FROM DUAL
		UNION ALL
		SELECT '8808983680279' GLN FROM DUAL
		UNION ALL
		SELECT '8808983690018' GLN FROM DUAL
		UNION ALL
		SELECT '8808983690049' GLN FROM DUAL
		UNION ALL
		SELECT '8808983700014' GLN FROM DUAL
		UNION ALL
		SELECT '8808983700069' GLN FROM DUAL
		UNION ALL
		SELECT '8808983700250' GLN FROM DUAL
		UNION ALL
		SELECT '8808983700274' GLN FROM DUAL
		UNION ALL
		SELECT '8808983700298' GLN FROM DUAL
		UNION ALL
		SELECT '8808983700472' GLN FROM DUAL
		UNION ALL
		SELECT '8808983710365' GLN FROM DUAL
		UNION ALL
		SELECT '8808983710440' GLN FROM DUAL
		UNION ALL
		SELECT '8808983720081' GLN FROM DUAL
		UNION ALL
		SELECT '8808983720135' GLN FROM DUAL
		UNION ALL
		SELECT '8808983720760' GLN FROM DUAL
		UNION ALL
		SELECT '8808983721255' GLN FROM DUAL
		UNION ALL
		SELECT '8808983721903' GLN FROM DUAL
		UNION ALL
		SELECT '8808983721927' GLN FROM DUAL
		UNION ALL
		SELECT '8808983721934' GLN FROM DUAL
		UNION ALL
		SELECT '8808983721965' GLN FROM DUAL
		UNION ALL
		SELECT '8808983722276' GLN FROM DUAL
		UNION ALL
		SELECT '8808983722283' GLN FROM DUAL
		UNION ALL
		SELECT '8808983722290' GLN FROM DUAL
		UNION ALL
		SELECT '8808983722559' GLN FROM DUAL
		UNION ALL
		SELECT '8808983722566' GLN FROM DUAL
		UNION ALL
		SELECT '8808983722993' GLN FROM DUAL
		UNION ALL
		SELECT '8808983723211' GLN FROM DUAL
		UNION ALL
		SELECT '8808983723259' GLN FROM DUAL
		UNION ALL
		SELECT '8808983723266' GLN FROM DUAL
		UNION ALL
		SELECT '8808983727028' GLN FROM DUAL
		UNION ALL
		SELECT '8808983727226' GLN FROM DUAL
		UNION ALL
		SELECT '8808983730417' GLN FROM DUAL
		UNION ALL
		SELECT '8808983730448' GLN FROM DUAL
		UNION ALL
		SELECT '8808983730486' GLN FROM DUAL
		UNION ALL
		SELECT '8808983732343' GLN FROM DUAL
		UNION ALL
		SELECT '8808983740508' GLN FROM DUAL
		UNION ALL
		SELECT '8808983740669' GLN FROM DUAL
		UNION ALL
		SELECT '8808983750194' GLN FROM DUAL
		UNION ALL
		SELECT '8808983750200' GLN FROM DUAL
		UNION ALL
		SELECT '8808983750248' GLN FROM DUAL
		UNION ALL
		SELECT '8808983750323' GLN FROM DUAL
		UNION ALL
		SELECT '8808983750910' GLN FROM DUAL
		UNION ALL
		SELECT '8808983751542' GLN FROM DUAL
		UNION ALL
		SELECT '8808983751566' GLN FROM DUAL
		UNION ALL
		SELECT '8808983751672' GLN FROM DUAL
		UNION ALL
		SELECT '8808983751726' GLN FROM DUAL
		UNION ALL
		SELECT '8808983751740' GLN FROM DUAL
		UNION ALL
		SELECT '8808983751924' GLN FROM DUAL
		UNION ALL
		SELECT '8808983752051' GLN FROM DUAL
		UNION ALL
		SELECT '8808983752068' GLN FROM DUAL
		UNION ALL
		SELECT '8808983752167' GLN FROM DUAL
		UNION ALL
		SELECT '8808983752181' GLN FROM DUAL
		UNION ALL
		SELECT '8808983752303' GLN FROM DUAL
		UNION ALL
		SELECT '8808983752389' GLN FROM DUAL
		UNION ALL
		SELECT '8808983752822' GLN FROM DUAL
		UNION ALL
		SELECT '8808983757087' GLN FROM DUAL
		UNION ALL
		SELECT '8808983759012' GLN FROM DUAL
		UNION ALL
		SELECT '8808983760117' GLN FROM DUAL
		UNION ALL
		SELECT '8808983760155' GLN FROM DUAL
		UNION ALL
		SELECT '8808983760186' GLN FROM DUAL
		UNION ALL
		SELECT '8808983760209' GLN FROM DUAL
		UNION ALL
		SELECT '8808983760216' GLN FROM DUAL
		UNION ALL
		SELECT '8808983760308' GLN FROM DUAL
		UNION ALL
		SELECT '8808983760544' GLN FROM DUAL
		UNION ALL
		SELECT '8808983760704' GLN FROM DUAL
		UNION ALL
		SELECT '8808983760766' GLN FROM DUAL
		UNION ALL
		SELECT '8808983760926' GLN FROM DUAL
		UNION ALL
		SELECT '8808983767116' GLN FROM DUAL
		UNION ALL
		SELECT '8808983767482' GLN FROM DUAL
		UNION ALL
		SELECT '8808983767512' GLN FROM DUAL
		UNION ALL
		SELECT '8808983769028' GLN FROM DUAL
		UNION ALL
		SELECT '8808983769042' GLN FROM DUAL
		UNION ALL
		SELECT '8808983769059' GLN FROM DUAL
		),
		TB_TEMP AS (
		SELECT AA.*,ROUND((AA.CNR_CNT / AA.DLV_CNT) * 100, 1) AS CNR_PCT
		FROM (
		SELECT A.SPYPL_NA_TRPL_C, A.DVYAA_NA_TRPL_C, A.DVY_PLA_DT, COUNT(A.SPYPL_NA_TRPL_C) AS DLV_CNT, 
		          CASE WHEN C.GLN IS NOT NULL THEN COUNT(A.SPYPL_NA_TRPL_C) 
		                  ELSE COUNT(B.TR_BASS_NO)
		          END AS CNR_CNT 
		FROM TB_OD_DLVPNSHT_M A
		LEFT OUTER JOIN TB_PD_BYNG_CNR_M B ON (B.NA_BZPLC = A.DVYAA_NA_TRPL_C
		AND B.ODR_DT = A.DVY_PLA_DT
		AND B.TR_BASS_NO = A.NA_DVY_PLASH_SLPNO
		AND B.BUYPL_NA_TRPL_C = A.SPYPL_NA_TRPL_C
		AND B.CNR_STS_DSC IN ('3', '4'))
		LEFT OUTER JOIN TB_AP_MART_TEMP C ON A.DVYAA_NA_TRPL_C = C.GLN
		<if test='centercode != "A"'>
		WHERE A.SPYPL_NA_TRPL_C = #{centercode}
		</if>
		<if test='centercode == "A"'>
		WHERE A.SPYPL_NA_TRPL_C IN (SELECT GLN FROM TB_GLN_TEMP)
		</if>
		AND A.DVY_PLA_DT BETWEEN #{FROM_DATE} AND #{TO_DATE}
		AND A.DVYAA_NA_TRPL_C NOT IN (SELECT GLN FROM TB_GLN_TEMP)
		AND A.PRC_YN = 'R' 
		AND A.WK_DS <![CDATA[<>]]> 'D' 
		AND NVL(A.GRS_SOJU_YN, '0') <![CDATA[<>]]> '1' 
		GROUP BY A.SPYPL_NA_TRPL_C, A.DVYAA_NA_TRPL_C, A.DVY_PLA_DT, C.GLN
		) AA
		ORDER BY AA.SPYPL_NA_TRPL_C, AA.DVYAA_NA_TRPL_C, AA.DVY_PLA_DT
		)
		SELECT A.SPYPL_NA_TRPL_C, B.CLNTNM AS SPYPL_NM, A.DVYAA_NA_TRPL_C, C.CLNTNM AS DVYAA_NM,
		<foreach collection="DAYLIST" item="item" index="index" separator=",">
 		SUM(C${item}) C${item}
 		</foreach>
		FROM (
		SELECT SPYPL_NA_TRPL_C, DVYAA_NA_TRPL_C, DVY_PLA_DT,
		<foreach collection="DAYLIST" item="item" index="index" separator=",">
		DECODE(DVY_PLA_DT, ${item}, CNR_CNT) AS C${item}
		</foreach>  
		FROM TB_TEMP
		) A
		LEFT OUTER JOIN TB_TR_TRPL_CIF B ON (A.SPYPL_NA_TRPL_C = B.NA_TRPL_C)
		LEFT OUTER JOIN TB_TR_TRPL_CIF C ON (A.DVYAA_NA_TRPL_C = C.NA_TRPL_C)
		LEFT OUTER JOIN TB_GLN_TEMP D ON (A.SPYPL_NA_TRPL_C = D.GLN)
		GROUP BY A.SPYPL_NA_TRPL_C, D.SEQ, B.CLNTNM, A.DVYAA_NA_TRPL_C, C.CLNTNM
		ORDER BY D.SEQ, A.DVYAA_NA_TRPL_C
	</select>
	
	<select id="selectList" parameterType="java.util.Map" resultType="java.util.Map" fetchSize="1000">
			WITH TB_GLN_TEMP AS (
		 		SELECT '01' SEQ, '8808983304892' GLN FROM DUAL
				UNION ALL
				SELECT '02' SEQ, '8808983304908' GLN FROM DUAL
				UNION ALL
				SELECT '03' SEQ, '8808983300108' GLN FROM DUAL
				UNION ALL
				SELECT '05' SEQ, '8808983000312' GLN FROM DUAL
				UNION ALL
				SELECT '06' SEQ, '8808983000916' GLN FROM DUAL
				UNION ALL
				SELECT '08' SEQ, '8808983000510' GLN FROM DUAL
				UNION ALL
				SELECT '09' SEQ, '8808983305950' GLN FROM DUAL
				UNION ALL
				SELECT '11' SEQ, '8808983000411' GLN FROM DUAL
				UNION ALL
				SELECT '12' SEQ, '8808983327631' GLN FROM DUAL
			),
				TB_AP_MART_TEMP AS (
				SELECT '8808983120218' GLN FROM DUAL
				UNION ALL
				SELECT '8808983300597' GLN FROM DUAL
				UNION ALL
				SELECT '8808983300689' GLN FROM DUAL
				UNION ALL
				SELECT '8808983300818' GLN FROM DUAL
				UNION ALL
				SELECT '8808983300825' GLN FROM DUAL
				UNION ALL
				SELECT '8808983301235' GLN FROM DUAL
				UNION ALL
				SELECT '8808983301259' GLN FROM DUAL
				UNION ALL
				SELECT '8808983301273' GLN FROM DUAL
				UNION ALL
				SELECT '8808983301303' GLN FROM DUAL
				UNION ALL
				SELECT '8808983301358' GLN FROM DUAL
				UNION ALL
				SELECT '8808983302003' GLN FROM DUAL
				UNION ALL
				SELECT '8808983302508' GLN FROM DUAL
				UNION ALL
				SELECT '8808983304700' GLN FROM DUAL
				UNION ALL
				SELECT '8808983305783' GLN FROM DUAL
				UNION ALL
				SELECT '8808983305790' GLN FROM DUAL
				UNION ALL
				SELECT '8808983306094' GLN FROM DUAL
				UNION ALL
				SELECT '8808983306995' GLN FROM DUAL
				UNION ALL
				SELECT '8808983307039' GLN FROM DUAL
				UNION ALL
				SELECT '8808983307282' GLN FROM DUAL
				UNION ALL
				SELECT '8808983307312' GLN FROM DUAL
				UNION ALL
				SELECT '8808983307978' GLN FROM DUAL
				UNION ALL
				SELECT '8808983321615' GLN FROM DUAL
				UNION ALL
				SELECT '8808983321752' GLN FROM DUAL
				UNION ALL
				SELECT '8808983322322' GLN FROM DUAL
				UNION ALL
				SELECT '8808983323046' GLN FROM DUAL
				UNION ALL
				SELECT '8808983323602' GLN FROM DUAL
				UNION ALL
				SELECT '8808983323909' GLN FROM DUAL
				UNION ALL
				SELECT '8808983324197' GLN FROM DUAL
				UNION ALL
				SELECT '8808983324203' GLN FROM DUAL
				UNION ALL
				SELECT '8808983325552' GLN FROM DUAL
				UNION ALL
				SELECT '8808983325736' GLN FROM DUAL
				UNION ALL
				SELECT '8808983325804' GLN FROM DUAL
				UNION ALL
				SELECT '8808983325903' GLN FROM DUAL
				UNION ALL
				SELECT '8808983325958' GLN FROM DUAL
				UNION ALL
				SELECT '8808983325965' GLN FROM DUAL
				UNION ALL
				SELECT '8808983326016' GLN FROM DUAL
				UNION ALL
				SELECT '8808983326818' GLN FROM DUAL
				UNION ALL
				SELECT '8808983326993' GLN FROM DUAL
				UNION ALL
				SELECT '8808983327037' GLN FROM DUAL
				UNION ALL
				SELECT '8808983327211' GLN FROM DUAL
				UNION ALL
				SELECT '8808983327402' GLN FROM DUAL
				UNION ALL
				SELECT '8808983327518' GLN FROM DUAL
				UNION ALL
				SELECT '8808983328126' GLN FROM DUAL
				UNION ALL
				SELECT '8808983328300' GLN FROM DUAL
				UNION ALL
				SELECT '8808983410159' GLN FROM DUAL
				UNION ALL
				SELECT '8808983420028' GLN FROM DUAL
				UNION ALL
				SELECT '8808983420035' GLN FROM DUAL
				UNION ALL
				SELECT '8808983420059' GLN FROM DUAL
				UNION ALL
				SELECT '8808983420110' GLN FROM DUAL
				UNION ALL
				SELECT '8808983421117' GLN FROM DUAL
				UNION ALL
				SELECT '8808983421216' GLN FROM DUAL
				UNION ALL
				SELECT '8808983421315' GLN FROM DUAL
				UNION ALL
				SELECT '8808983430058' GLN FROM DUAL
				UNION ALL
				SELECT '8808983430065' GLN FROM DUAL
				UNION ALL
				SELECT '8808983431116' GLN FROM DUAL
				UNION ALL
				SELECT '8808983440019' GLN FROM DUAL
				UNION ALL
				SELECT '8808983610122' GLN FROM DUAL
				UNION ALL
				SELECT '8808983610252' GLN FROM DUAL
				UNION ALL
				SELECT '8808983610276' GLN FROM DUAL
				UNION ALL
				SELECT '8808983610337' GLN FROM DUAL
				UNION ALL
				SELECT '8808983610351' GLN FROM DUAL
				UNION ALL
				SELECT '8808983610375' GLN FROM DUAL
				UNION ALL
				SELECT '8808983610382' GLN FROM DUAL
				UNION ALL
				SELECT '8808983610399' GLN FROM DUAL
				UNION ALL
				SELECT '8808983610573' GLN FROM DUAL
				UNION ALL
				SELECT '8808983610580' GLN FROM DUAL
				UNION ALL
				SELECT '8808983610603' GLN FROM DUAL
				UNION ALL
				SELECT '8808983610818' GLN FROM DUAL
				UNION ALL
				SELECT '8808983610948' GLN FROM DUAL
				UNION ALL
				SELECT '8808983611051' GLN FROM DUAL
				UNION ALL
				SELECT '8808983611143' GLN FROM DUAL
				UNION ALL
				SELECT '8808983611150' GLN FROM DUAL
				UNION ALL
				SELECT '8808983611563' GLN FROM DUAL
				UNION ALL
				SELECT '8808983617077' GLN FROM DUAL
				UNION ALL
				SELECT '8808983617206' GLN FROM DUAL
				UNION ALL
				SELECT '8808983617312' GLN FROM DUAL
				UNION ALL
				SELECT '8808983617381' GLN FROM DUAL
				UNION ALL
				SELECT '8808983617404' GLN FROM DUAL
				UNION ALL
				SELECT '8808983617473' GLN FROM DUAL
				UNION ALL
				SELECT '8808983617497' GLN FROM DUAL
				UNION ALL
				SELECT '8808983617565' GLN FROM DUAL
				UNION ALL
				SELECT '8808983620152' GLN FROM DUAL
				UNION ALL
				SELECT '8808983620176' GLN FROM DUAL
				UNION ALL
				SELECT '8808983620206' GLN FROM DUAL
				UNION ALL
				SELECT '8808983620220' GLN FROM DUAL
				UNION ALL
				SELECT '8808983620497' GLN FROM DUAL
				UNION ALL
				SELECT '8808983620510' GLN FROM DUAL
				UNION ALL
				SELECT '8808983620886' GLN FROM DUAL
				UNION ALL
				SELECT '8808983620961' GLN FROM DUAL
				UNION ALL
				SELECT '8808983621050' GLN FROM DUAL
				UNION ALL
				SELECT '8808983621197' GLN FROM DUAL
				UNION ALL
				SELECT '8808983621340' GLN FROM DUAL
				UNION ALL
				SELECT '8808983621401' GLN FROM DUAL
				UNION ALL
				SELECT '8808983621500' GLN FROM DUAL
				UNION ALL
				SELECT '8808983621616' GLN FROM DUAL
				UNION ALL
				SELECT '8808983621678' GLN FROM DUAL
				UNION ALL
				SELECT '8808983622040' GLN FROM DUAL
				UNION ALL
				SELECT '8808983622149' GLN FROM DUAL
				UNION ALL
				SELECT '8808983622392' GLN FROM DUAL
				UNION ALL
				SELECT '8808983622477' GLN FROM DUAL
				UNION ALL
				SELECT '8808983622514' GLN FROM DUAL
				UNION ALL
				SELECT '8808983622590' GLN FROM DUAL
				UNION ALL
				SELECT '8808983622606' GLN FROM DUAL
				UNION ALL
				SELECT '8808983622705' GLN FROM DUAL
				UNION ALL
				SELECT '8808983622750' GLN FROM DUAL
				UNION ALL
				SELECT '8808983622798' GLN FROM DUAL
				UNION ALL
				SELECT '8808983622804' GLN FROM DUAL
				UNION ALL
				SELECT '8808983622835' GLN FROM DUAL
				UNION ALL
				SELECT '8808983622866' GLN FROM DUAL
				UNION ALL
				SELECT '8808983623108' GLN FROM DUAL
				UNION ALL
				SELECT '8808983623146' GLN FROM DUAL
				UNION ALL
				SELECT '8808983623290' GLN FROM DUAL
				UNION ALL
				SELECT '8808983623450' GLN FROM DUAL
				UNION ALL
				SELECT '8808983623467' GLN FROM DUAL
				UNION ALL
				SELECT '8808983623481' GLN FROM DUAL
				UNION ALL
				SELECT '8808983623832' GLN FROM DUAL
				UNION ALL
				SELECT '8808983623917' GLN FROM DUAL
				UNION ALL
				SELECT '8808983630014' GLN FROM DUAL
				UNION ALL
				SELECT '8808983630281' GLN FROM DUAL
				UNION ALL
				SELECT '8808983631004' GLN FROM DUAL
				UNION ALL
				SELECT '8808983631363' GLN FROM DUAL
				UNION ALL
				SELECT '8808983631554' GLN FROM DUAL
				UNION ALL
				SELECT '8808983631790' GLN FROM DUAL
				UNION ALL
				SELECT '8808983632438' GLN FROM DUAL
				UNION ALL
				SELECT '8808983632544' GLN FROM DUAL
				UNION ALL
				SELECT '8808983632551' GLN FROM DUAL
				UNION ALL
				SELECT '8808983632568' GLN FROM DUAL
				UNION ALL
				SELECT '8808983632636' GLN FROM DUAL
				UNION ALL
				SELECT '8808983632681' GLN FROM DUAL
				UNION ALL
				SELECT '8808983632704' GLN FROM DUAL
				UNION ALL
				SELECT '8808983632797' GLN FROM DUAL
				UNION ALL
				SELECT '8808983632858' GLN FROM DUAL
				UNION ALL
				SELECT '8808983633473' GLN FROM DUAL
				UNION ALL
				SELECT '8808983633503' GLN FROM DUAL
				UNION ALL
				SELECT '8808983633978' GLN FROM DUAL
				UNION ALL
				SELECT '8808983637532' GLN FROM DUAL
				UNION ALL
				SELECT '8808983640280' GLN FROM DUAL
				UNION ALL
				SELECT '8808983640563' GLN FROM DUAL
				UNION ALL
				SELECT '8808983641058' GLN FROM DUAL
				UNION ALL
				SELECT '8808983641591' GLN FROM DUAL
				UNION ALL
				SELECT '8808983641645' GLN FROM DUAL
				UNION ALL
				SELECT '8808983641805' GLN FROM DUAL
				UNION ALL
				SELECT '8808983641843' GLN FROM DUAL
				UNION ALL
				SELECT '8808983641966' GLN FROM DUAL
				UNION ALL
				SELECT '8808983642000' GLN FROM DUAL
				UNION ALL
				SELECT '8808983642086' GLN FROM DUAL
				UNION ALL
				SELECT '8808983642598' GLN FROM DUAL
				UNION ALL
				SELECT '8808983643229' GLN FROM DUAL
				UNION ALL
				SELECT '8808983643564' GLN FROM DUAL
				UNION ALL
				SELECT '8808983647210' GLN FROM DUAL
				UNION ALL
				SELECT '8808983650067' GLN FROM DUAL
				UNION ALL
				SELECT '8808983650869' GLN FROM DUAL
				UNION ALL
				SELECT '8808983660011' GLN FROM DUAL
				UNION ALL
				SELECT '8808983660042' GLN FROM DUAL
				UNION ALL
				SELECT '8808983660271' GLN FROM DUAL
				UNION ALL
				SELECT '8808983670119' GLN FROM DUAL
				UNION ALL
				SELECT '8808983670188' GLN FROM DUAL
				UNION ALL
				SELECT '8808983670232' GLN FROM DUAL
				UNION ALL
				SELECT '8808983670249' GLN FROM DUAL
				UNION ALL
				SELECT '8808983670317' GLN FROM DUAL
				UNION ALL
				SELECT '8808983670379' GLN FROM DUAL
				UNION ALL
				SELECT '8808983677026' GLN FROM DUAL
				UNION ALL
				SELECT '8808983680255' GLN FROM DUAL
				UNION ALL
				SELECT '8808983680279' GLN FROM DUAL
				UNION ALL
				SELECT '8808983690018' GLN FROM DUAL
				UNION ALL
				SELECT '8808983690049' GLN FROM DUAL
				UNION ALL
				SELECT '8808983700014' GLN FROM DUAL
				UNION ALL
				SELECT '8808983700069' GLN FROM DUAL
				UNION ALL
				SELECT '8808983700250' GLN FROM DUAL
				UNION ALL
				SELECT '8808983700274' GLN FROM DUAL
				UNION ALL
				SELECT '8808983700298' GLN FROM DUAL
				UNION ALL
				SELECT '8808983700472' GLN FROM DUAL
				UNION ALL
				SELECT '8808983710365' GLN FROM DUAL
				UNION ALL
				SELECT '8808983710440' GLN FROM DUAL
				UNION ALL
				SELECT '8808983720081' GLN FROM DUAL
				UNION ALL
				SELECT '8808983720135' GLN FROM DUAL
				UNION ALL
				SELECT '8808983720760' GLN FROM DUAL
				UNION ALL
				SELECT '8808983721255' GLN FROM DUAL
				UNION ALL
				SELECT '8808983721903' GLN FROM DUAL
				UNION ALL
				SELECT '8808983721927' GLN FROM DUAL
				UNION ALL
				SELECT '8808983721934' GLN FROM DUAL
				UNION ALL
				SELECT '8808983721965' GLN FROM DUAL
				UNION ALL
				SELECT '8808983722276' GLN FROM DUAL
				UNION ALL
				SELECT '8808983722283' GLN FROM DUAL
				UNION ALL
				SELECT '8808983722290' GLN FROM DUAL
				UNION ALL
				SELECT '8808983722559' GLN FROM DUAL
				UNION ALL
				SELECT '8808983722566' GLN FROM DUAL
				UNION ALL
				SELECT '8808983722993' GLN FROM DUAL
				UNION ALL
				SELECT '8808983723211' GLN FROM DUAL
				UNION ALL
				SELECT '8808983723259' GLN FROM DUAL
				UNION ALL
				SELECT '8808983723266' GLN FROM DUAL
				UNION ALL
				SELECT '8808983727028' GLN FROM DUAL
				UNION ALL
				SELECT '8808983727226' GLN FROM DUAL
				UNION ALL
				SELECT '8808983730417' GLN FROM DUAL
				UNION ALL
				SELECT '8808983730448' GLN FROM DUAL
				UNION ALL
				SELECT '8808983730486' GLN FROM DUAL
				UNION ALL
				SELECT '8808983732343' GLN FROM DUAL
				UNION ALL
				SELECT '8808983740508' GLN FROM DUAL
				UNION ALL
				SELECT '8808983740669' GLN FROM DUAL
				UNION ALL
				SELECT '8808983750194' GLN FROM DUAL
				UNION ALL
				SELECT '8808983750200' GLN FROM DUAL
				UNION ALL
				SELECT '8808983750248' GLN FROM DUAL
				UNION ALL
				SELECT '8808983750323' GLN FROM DUAL
				UNION ALL
				SELECT '8808983750910' GLN FROM DUAL
				UNION ALL
				SELECT '8808983751542' GLN FROM DUAL
				UNION ALL
				SELECT '8808983751566' GLN FROM DUAL
				UNION ALL
				SELECT '8808983751672' GLN FROM DUAL
				UNION ALL
				SELECT '8808983751726' GLN FROM DUAL
				UNION ALL
				SELECT '8808983751740' GLN FROM DUAL
				UNION ALL
				SELECT '8808983751924' GLN FROM DUAL
				UNION ALL
				SELECT '8808983752051' GLN FROM DUAL
				UNION ALL
				SELECT '8808983752068' GLN FROM DUAL
				UNION ALL
				SELECT '8808983752167' GLN FROM DUAL
				UNION ALL
				SELECT '8808983752181' GLN FROM DUAL
				UNION ALL
				SELECT '8808983752303' GLN FROM DUAL
				UNION ALL
				SELECT '8808983752389' GLN FROM DUAL
				UNION ALL
				SELECT '8808983752822' GLN FROM DUAL
				UNION ALL
				SELECT '8808983757087' GLN FROM DUAL
				UNION ALL
				SELECT '8808983759012' GLN FROM DUAL
				UNION ALL
				SELECT '8808983760117' GLN FROM DUAL
				UNION ALL
				SELECT '8808983760155' GLN FROM DUAL
				UNION ALL
				SELECT '8808983760186' GLN FROM DUAL
				UNION ALL
				SELECT '8808983760209' GLN FROM DUAL
				UNION ALL
				SELECT '8808983760216' GLN FROM DUAL
				UNION ALL
				SELECT '8808983760308' GLN FROM DUAL
				UNION ALL
				SELECT '8808983760544' GLN FROM DUAL
				UNION ALL
				SELECT '8808983760704' GLN FROM DUAL
				UNION ALL
				SELECT '8808983760766' GLN FROM DUAL
				UNION ALL
				SELECT '8808983760926' GLN FROM DUAL
				UNION ALL
				SELECT '8808983767116' GLN FROM DUAL
				UNION ALL
				SELECT '8808983767482' GLN FROM DUAL
				UNION ALL
				SELECT '8808983767512' GLN FROM DUAL
				UNION ALL
				SELECT '8808983769028' GLN FROM DUAL
				UNION ALL
				SELECT '8808983769042' GLN FROM DUAL
				UNION ALL
				SELECT '8808983769059' GLN FROM DUAL
				),
				TB_TEMP AS (
				SELECT CC.SPYPL_NA_TRPL_C, CC.DVY_PLA_DT, SUM(CC.DLV_CNT) DLV_CNT, SUM(CNR_CNT) CNR_CNT FROM (
				SELECT BB.SPYPL_NA_TRPL_C, BB.DVYAA_NA_TRPL_C, BB.DVY_PLA_DT, DECODE(BB.DLV_CNT, 0, 0, 1) DLV_CNT, DECODE(CNR_CNT, 0, 0, 1) CNR_CNT FROM (
				SELECT AA.*,ROUND((AA.CNR_CNT / AA.DLV_CNT) * 100, 1) AS CNR_PCT
				FROM (
				SELECT A.SPYPL_NA_TRPL_C, A.DVYAA_NA_TRPL_C, A.DVY_PLA_DT, COUNT(A.SPYPL_NA_TRPL_C) AS DLV_CNT, 
				          CASE WHEN C.GLN IS NOT NULL THEN COUNT(A.SPYPL_NA_TRPL_C) 
				                  ELSE COUNT(B.TR_BASS_NO)
				          END AS CNR_CNT 
				FROM TB_OD_DLVPNSHT_M A
				LEFT OUTER JOIN TB_PD_BYNG_CNR_M B ON (B.NA_BZPLC = A.DVYAA_NA_TRPL_C
				AND B.ODR_DT = A.DVY_PLA_DT
				AND B.TR_BASS_NO = A.NA_DVY_PLASH_SLPNO
				AND B.BUYPL_NA_TRPL_C = A.SPYPL_NA_TRPL_C
				AND B.CNR_STS_DSC IN ('3', '4'))
				LEFT OUTER JOIN TB_AP_MART_TEMP C ON A.DVYAA_NA_TRPL_C = C.GLN
				<if test='centercode != "A"'>
					WHERE A.SPYPL_NA_TRPL_C = #{centercode}
				</if>
				<if test='centercode == "A"'>
					WHERE A.SPYPL_NA_TRPL_C IN (SELECT GLN FROM TB_GLN_TEMP)
				</if>
					AND A.DVY_PLA_DT BETWEEN #{FROM_DATE} AND #{TO_DATE}
					AND A.DVYAA_NA_TRPL_C NOT IN (SELECT GLN FROM TB_GLN_TEMP)
					AND A.PRC_YN = 'R'
					AND A.WK_DS <![CDATA[<>]]> 'D' 
					AND NVL(A.GRS_SOJU_YN, '0') <![CDATA[<>]]> '1' 
				  GROUP BY A.SPYPL_NA_TRPL_C, A.DVYAA_NA_TRPL_C, A.DVY_PLA_DT, C.GLN
				  ) AA
				  ) BB
				  ) CC
				  GROUP BY CC.SPYPL_NA_TRPL_C, CC.DVY_PLA_DT
				  ORDER BY CC.SPYPL_NA_TRPL_C, CC.DVY_PLA_DT
				  ),
				  TB_TEMP2 AS (
				  SELECT BB.SEQ, AA.SPYPL_NA_TRPL_C, AA.SPYPL_NM,
						<foreach collection="DAYLIST" item="item" index="index" separator=",">
				    		AA.D${item}, AA.C${item}, ROUND((AA.C${item} / AA.D${item}) * 100, 1) D${item}_PCT
						</foreach>
						FROM (
						SELECT A.SPYPL_NA_TRPL_C, B.CLNTNM AS SPYPL_NM,
						<foreach collection="DAYLIST" item="item" index="index" separator=",">
							SUM(D${item}) D${item}, SUM(C${item}) C${item}
						</foreach> 
						FROM (
						SELECT SPYPL_NA_TRPL_C, DVY_PLA_DT,
						<foreach collection="DAYLIST" item="item" index="index" separator=",">
						  	DECODE(DVY_PLA_DT, ${item}, DLV_CNT) AS D${item}, DECODE(DVY_PLA_DT, ${item}, CNR_CNT) AS C${item}
						</foreach>  
						FROM TB_TEMP
						) A 
						LEFT OUTER JOIN TB_TR_TRPL_CIF B ON (A.SPYPL_NA_TRPL_C = B.NA_TRPL_C)
						GROUP BY A.SPYPL_NA_TRPL_C, B.CLNTNM
						) AA
						LEFT OUTER JOIN TB_GLN_TEMP BB ON (AA.SPYPL_NA_TRPL_C = BB.GLN)
						)
						SELECT * FROM (
						SELECT SEQ, SPYPL_NA_TRPL_C, SPYPL_NM,
						<foreach collection="DAYLIST" item="item" index="index" separator=",">
						  	D${item}_PCT
						</foreach>
						FROM TB_TEMP2
						) ORDER BY SEQ
	</select>
</mapper>